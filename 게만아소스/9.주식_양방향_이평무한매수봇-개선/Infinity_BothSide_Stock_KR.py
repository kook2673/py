'''

ê´€ë ¨ í¬ìŠ¤íŒ…

ê¸ˆë‹¨ì˜ ì—´ë§¤! ë¡±? ìˆ? ì–‘ë°©í–¥ ë ˆë²„ë¦¬ì§€ íˆ¬ìë¡œ ì•ˆì •ì ì¸ 0.5%ì”© ìˆ˜ìµ ë¨¹ê¸° ê°€ëŠ¥í• ê¹Œ?? (ì£¼ì‹ ì–‘ë°©í–¥ ë§¤ë§¤)
https://blog.naver.com/zacra/222988877129

ìœ„ í¬ìŠ¤íŒ…ì„ ê¼­ ì°¸ê³ í•˜ì„¸ìš”!!!


ğŸ“Œ [ì½”ë“œ ì œê³µ ëª©ì ]

ì´ ì½”ë“œëŠ” í´ë˜ìŠ¤101 ê²Œë§Œì•„ <íŒŒì´ì¬ ìë™ë§¤ë§¤ ë´‡ ë§Œë“¤ê¸°> ê°•ì˜ì˜ ë³´ì¡° ìë£Œë¡œ ì œê³µë˜ë©°,  
ê°•ì˜ ìˆ˜ê°•ìƒì˜ **í•™ìŠµ ë° ì‹¤ìŠµì„ ìœ„í•œ ì°¸ê³ ìš© ì˜ˆì‹œ ì½”ë“œ**ì…ë‹ˆë‹¤.  
**íˆ¬ì ê¶Œìœ , ì¢…ëª© ì¶”ì²œ, ìë¬¸ ë˜ëŠ” ì¼ì„ì„ ìœ„í•œ ëª©ì ì€ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.**

ğŸ“Œ [ê¸°ìˆ  êµ¬í˜„ ê´€ë ¨ ì•ˆë‚´]

- ë³¸ ì½”ë“œëŠ” **ì¦ê¶Œì‚¬ì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì œê³µí•œ API** ë°  
  **ê³µì‹ ê°œë°œì ê°€ì´ë“œ ë¬¸ì„œ**ì— ë”°ë¼ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.
- í•´ë‹¹ APIëŠ” ì¼ë°˜ íˆ¬ìì ëˆ„êµ¬ë‚˜ ì´ìš© ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ì´ë©°,  
  ë³¸ ì½”ë“œëŠ” ê·¸ê²ƒì„ êµ¬í˜„í•œ ì˜ˆì‹œë¥¼ í™œìš©í•´ ì „ëµì„ êµ¬í˜„í•´ë³´ëŠ” í•™ìŠµ ëª©ì ìœ¼ë¡œ í™œìš©í•œ ê²ƒì…ë‹ˆë‹¤.

ğŸ“Œ [ì „ëµ ì‹¤í–‰ ì¡°ê±´]

- ë³¸ ì½”ë“œëŠ” ìë™ ë°˜ë³µ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©°, ì‚¬ìš©ìê°€ ì§ì ‘ ì‹¤í–‰í•´ì•¼ 1íšŒ ë™ì‘í•©ë‹ˆë‹¤.
- ë°˜ë³µ ì‹¤í–‰ì„ ì›í•  ê²½ìš°, ì‚¬ìš©ìê°€ ë³„ë„ë¡œ ì„œë²„ ë° ìŠ¤ì¼€ì¤„ëŸ¬ êµ¬ì„±ì„ í•´ì•¼ í•©ë‹ˆë‹¤.


- ë³¸ ì½”ë“œì—ëŠ” ì¦ê¶Œì‚¬ ì œê³µ APIë¥¼ í™œìš©í•œ ë§¤ë§¤ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë‚˜,  
  **ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •ì„ ë³€ê²½í•˜ì§€ ì•ŠëŠ” í•œ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
  

- ì „ëµ ì‹¤í–‰ì„ ìœ„í•´ì„œëŠ” ë‹¤ìŒì˜ ê³¼ì •ì„ **ì‚¬ìš©ìê°€ ì§ì ‘** ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤:

  1. `ENABLE_ORDER_EXECUTION` ê°’ì„ `True`ë¡œ ë³€ê²½  
  2. `InvestRate` ë¹„ì¤‘ì„ ì„¤ì • (ê¸°ë³¸ê°’: 0)  
  3. ë§¤ìˆ˜í•  ì¢…ëª©ì„ ëª…ì‹œ (ê¸°ë³¸ê°’: ë¹ˆ ë¦¬ìŠ¤íŠ¸)  
  4. AWS ë˜ëŠ” ê°œì¸ ì„œë²„ êµ¬ì¶• ë° `crontab` ë˜ëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ ë“±ë¡

- ì œê³µìëŠ” ì„œë²„ êµ¬ì¶•, ì„¤ì •, ì‹¤í–‰ ëŒ€í–‰ ë“±ì„ ì „í˜€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ğŸ“Œ [ë²•ì  ì±…ì„ ê³ ì§€]

- ì œê³µë˜ëŠ” ì½”ë“œëŠ” ê¸°ìˆ  í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ ëª©ì ì˜ ì˜ˆì‹œ ì½”ë“œì…ë‹ˆë‹¤.  
- **ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” ê³¼ê±° ë°ì´í„° ê¸°ë°˜ì´ë©°, ë¯¸ë˜ ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

- ë³¸ ì½”ë“œì˜ ì‚¬ìš©, ìˆ˜ì •, ì‹¤í–‰ì— ë”°ë¥¸ ëª¨ë“  ê²°ê³¼ì™€ ì±…ì„ì€ ì‚¬ìš©ìì—ê²Œ ìˆìœ¼ë©°,  
  **ì œê³µìëŠ” ë²•ì Â·ê¸ˆì „ì  ì±…ì„ì„ ì¼ì ˆ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.**

ğŸ“Œ [ì €ì‘ê¶Œ ì•ˆë‚´]

- ì´ ì½”ë“œëŠ” ì €ì‘ê¶Œë²• ë° ë¶€ì •ê²½ìŸë°©ì§€ë²•ì˜ ë³´í˜¸ë¥¼ ë°›ìŠµë‹ˆë‹¤.  
- ë¬´ë‹¨ ë³µì œ, ê³µìœ , ì¬íŒë§¤, ë°°í¬ ì‹œ ë¯¼Â·í˜•ì‚¬ìƒ ì±…ì„ì´ ë”°ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸ“Œ [í•™ìŠµ ê¶Œì¥ ì‚¬í•­]

- ë³¸ ì˜ˆì‹œ ì½”ë“œëŠ” ì „ëµ êµ¬í˜„ì„ ì´í•´í•˜ê¸° ìœ„í•œ í…œí”Œë¦¿ì…ë‹ˆë‹¤.  
- ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìì‹ ë§Œì˜ ì „ëµì„ ê°œë°œí•´ë³´ì‹œê¸¸ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤ :)



ì£¼ì‹/ì½”ì¸ íŒŒì´ì¬ ë§¤ë§¤ FAQ
https://blog.naver.com/zacra/223203988739

FAQë¡œ í•´ê²° ì•ˆë˜ëŠ” ê¸°ìˆ ì ì¸ ë¬¸ì œëŠ” í´ë˜ìŠ¤101 ê°•ì˜ì˜ ëŒ“ê¸€ì´ë‚˜ ìœ„ í¬ìŠ¤íŒ…ì— ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”.
íŒŒì´ì¬ ì½”ë”©ì— ëŒ€í•œ ë‹µë³€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. í˜„í–‰ë²• ìƒ íˆ¬ì ê´€ë ¨ ì§ˆë¬¸ì€ ë‹µë³€ ë¶ˆê°€í•˜ë‹¤ëŠ” ì  ì•Œë ¤ë“œë ¤ìš”!

'''

import KIS_Common as Common
import KIS_API_Helper_KR as KisKR
import json
import pprint
import line_alert
import time

Common.SetChangeMode("VIRTUAL")




#####################################################################################################################################
'''
â€» ì£¼ë¬¸ ì‹¤í–‰ ì—¬ë¶€ ì„¤ì •

ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•  ê²½ìš°,  
ì „ëµì— ë”°ë¼ ë§¤ë§¤ê°€ ì¼ì–´ë‚©ë‹ˆë‹¤.

âš ï¸ ê¸°ë³¸ê°’ì€ Falseì´ë©°,  
ì‹¤í–‰ ì—¬ë¶€ëŠ” ì‚¬ìš©ì ë³¸ì¸ì´ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ê²°ì •í•´ì•¼ í•©ë‹ˆë‹¤.
'''

ENABLE_ORDER_EXECUTION = False  # ì£¼ë¬¸ ì‹¤í–‰ ì—¬ë¶€ ì„¤ì • (ê¸°ë³¸ê°’: False)

'''
ğŸ“Œ ë³¸ ì „ëµì€ ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ëŠ” ì˜ˆì‹œ ì½”ë“œì´ë©°,  
ì‹¤ì œ íˆ¬ì ë° ì£¼ë¬¸ ì‹¤í–‰ì€ ì‚¬ìš©ì ë³¸ì¸ì˜ ì˜ì‚¬ì™€ ì±…ì„ í•˜ì— ìˆ˜í–‰ë©ë‹ˆë‹¤.
'''
#####################################################################################################################################

'''
ğŸ“Œ íˆ¬ìí•  ì¢…ëª©ì€ ë³¸ì¸ì˜ ì„ íƒìœ¼ë¡œ ì•„ë˜ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì¶”ê°€í•˜ì„¸ìš”!
'''

#íˆ¬ìí•  ë¡±ê³¼ ìˆ
LongStockCode = ''
ShortStockCode = '' 
#LongStockCode = '122630' # KODEX ë ˆë²„ë¦¬ì§€(ë¡±) ì¶”ì²œì´ ì•„ë‹ˆë©° ì˜ˆì‹œì…ë‹ˆë‹¤!
#ShortStockCode = '252670' # KODEX 200ì„ ë¬¼ì¸ë²„ìŠ¤2X (ìˆ) ì¶”ì²œì´ ì•„ë‹ˆë©° ì˜ˆì‹œì…ë‹ˆë‹¤!

#ëª¨ë©˜í…€ ê³„ì‚°í•  ê¸°ì¤€ë˜ëŠ” ì¢…ëª©
StStockCode = "" 
#StStockCode = "069500" #KODEX 200 ì¶”ì²œì´ ì•„ë‹ˆë©° ì˜ˆì‹œì…ë‹ˆë‹¤!


#####################################################################################################################################

'''
ğŸ“Œ íˆ¬ì ë¹„ì¤‘ ì„¤ì •!
ê¸°ë³¸ì€ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ìš”.
ë³¸ì¸ì˜ íˆ¬ì ë¹„ì¤‘ì„ ì„¤ì •í•˜ì„¸ìš”! 

ì „ëµì—ì„œ í™œìš©í•  ì£¼ë¬¸ì´ 
ì‹œì¥ê°€ ì£¼ë¬¸ì´ë¼ë©´ 0 ~ 0.75 
ì§€ì •ê°€ ì£¼ë¬¸ì´ë¼ë©´ 0 ~ 0.98
ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ì„¸ìš”! (0.1 = 10% 0.5 = 50%)
'''
InvestRate = 0 #ì´ í‰ê°€ê¸ˆì•¡ì—ì„œ í•´ë‹¹ ë´‡ì—ê²Œ í• ë‹¹í•  ì´ ê¸ˆì•¡ë¹„ìœ¨ 0.1 = 10%  0.5 = 50%
#####################################################################################################################################


#íˆ¬ìí•  ì¢…ëª©! KODEX ë ˆë²„ë¦¬ì§€(ë¡±), 
TargetStockList = [LongStockCode,ShortStockCode]


#ì‹œê°„ ì •ë³´ë¥¼ ì½ëŠ”ë‹¤
time_info = time.gmtime()

if time_info.tm_hour in [0,1] and time_info.tm_min == 0:
    time.sleep(20.0)
    

BOT_NAME = Common.GetNowDist() + "_InfinityBothSideBot"




#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
############# í•´ë‹¹ ì „ëµìœ¼ë¡œ ë§¤ìˆ˜í•  ì¢…ëª© ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ####################
InfinityMaDataList = list()
#íŒŒì¼ ê²½ë¡œì…ë‹ˆë‹¤.
bot_file_path = "/var/autobot/KrStock_" + BOT_NAME + ".json"

try:
    #ì´ ë¶€ë¶„ì´ íŒŒì¼ì„ ì½ì–´ì„œ ë¦¬ìŠ¤íŠ¸ì— ë„£ì–´ì£¼ëŠ” ë¡œì§ì…ë‹ˆë‹¤. 
    with open(bot_file_path, 'r') as json_file:
        InfinityMaDataList = json.load(json_file)

except Exception as e:
    print("Exception by First")
################################################################
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#





#ë§ˆì¼“ì´ ì—´ë ¸ëŠ”ì§€ ì—¬ë¶€~!
IsMarketOpen = KisKR.IsMarketOpen()

#ì¥ì´ ì—´ë ¸ì„ ë•Œ!
if IsMarketOpen == True:



    #ì‹œê°„ ì •ë³´ë¥¼ ì½ëŠ”ë‹¤
    time_info = time.gmtime()
    strday = time_info.tm_mday
    print("strday: " , strday)



    #ë‚ ì§œ ì •ë³´ 
    MomentumInfoDict = dict()

    #íŒŒì¼ ê²½ë¡œì…ë‹ˆë‹¤.
    status_file_path = "/var/autobot/KrStock_" + BOT_NAME + "_MomentumDataInfo.json"
    try:
        with open(status_file_path, 'r') as json_file:
            MomentumInfoDict = json.load(json_file)

    except Exception as e:
        #ì²˜ìŒì—ëŠ” íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šì„í…Œë‹ˆê¹ ë‹¹ì—°íˆ ì˜ˆì™¸ì²˜ë¦¬ê°€ ë©ë‹ˆë‹¤!
        print("Exception by First")




    #ê¸°ë³¸ì ìœ¼ë¡œëŠ” False
    Calc_Momentum = False

    #ë§Œì•½ í‚¤ê°€ ì¡´ì¬ í•˜ì§€ ì•ŠëŠ”ë‹¤ ì¦‰ ì•„ì§ í•œë²ˆë„ ê¸°ì¤€ì´ ë˜ëŠ” ì¢…ëª©ì˜ ëª¨ë©˜í…€ì´ ê³„ì‚°ë˜ì§€ ì•Šì•˜ë‹¤
    if MomentumInfoDict.get("day_st") == None:

        #ëª¨ë©˜í…€ ê³„ì‚°í•´ì•¼í•¨!
        Calc_Momentum = True
        
    #ì˜¤ëŠ˜ ëª¨ë©˜í…€ì´ ê³„ì‚°ë˜ì—ˆë‹¤ë©´ ì˜¤ëŠ˜ ì¼ ì •ë³´ê°€ ë“¤ì–´ê°€ ìˆë‹¤.
    else:
        #ê·¸ëŸ¼ ê·¸ ì •ë³´ë‘ ë‹¤ë¥¼ë•Œë§Œ ì¦‰ ë‚ ì´ ë°”ë€Œì—ˆì„ ë•Œë§Œ ëª¨ë©˜í…€ ê³„ì‚°ì„ í•˜ë©´ ëœë‹¤.
        if MomentumInfoDict['day_st'] != strday:
            #ëª¨ë©˜í…€ ê³„ì‚°í•´ì•¼í•¨!
            Calc_Momentum = True


    Avg_Period = 10.0 #ê¸°ë³¸ì ìœ¼ë¡œ 10ê°œì›” or 10ì¼ ëª¨ë©”í…€

    if Calc_Momentum == True:

        df = Common.GetOhlcv("KR",StStockCode)




        Now_Price = Common.GetCloseData(df,-1) #í˜„ì¬ê°€

        MomentumInfoDict['Now_Price'] = float(Now_Price)

        #5ì¼ ì´í‰ì„ 
        MomentumInfoDict['Ma5_before3'] = Common.GetMA(df,5,-4)
        MomentumInfoDict['Ma5_before'] = Common.GetMA(df,5,-3)
        MomentumInfoDict['Ma5'] = Common.GetMA(df,5,-2)

        print("MA5",MomentumInfoDict['Ma5_before3'], "->", MomentumInfoDict['Ma5_before'], "-> ",MomentumInfoDict['Ma5'])

        #20ì¼ ì´í‰ì„ 
        MomentumInfoDict['Ma20_before'] = Common.GetMA(df,20,-3)
        MomentumInfoDict['Ma20'] = Common.GetMA(df,20,-2)

        print("MA20", MomentumInfoDict['Ma20_before'], "-> ",MomentumInfoDict['Ma20'])

        #ì–‘ë´‰ ìº”ë“¤ì¸ì§€ ì—¬ë¶€
        MomentumInfoDict['IsUpCandle'] = 0

        #ì‹œê°€ë³´ë‹¤ ì¢…ê°€ê°€ í¬ë‹¤ë©´ ì–‘ë´‰ì´ë‹¤
        if df['open'].iloc[-2] <= df['close'].iloc[-2]:
            MomentumInfoDict['IsUpCandle'] = 1

        print("IsUpCandle : ", MomentumInfoDict['IsUpCandle'])




        Up_Count = 0
        Start_Num = -20
        for i in range(1,int(Avg_Period)+1):
            
            CheckPrice = Common.GetCloseData(df,Start_Num)
            print(CheckPrice, "  <<-  df[-", Start_Num,"]")

            if Now_Price >= CheckPrice:
                print("UP!")
                Up_Count += 1.0


            Start_Num -= 20

        avg_month_momentum_score = Up_Count/Avg_Period

        print("10ê°œì›” í‰ê·  ëª¨ë©˜í…€ ", avg_month_momentum_score)




        Up_Count = 0
        Start_Num = -10
        for i in range(1,int(Avg_Period)+1):
            
            CheckPrice = Common.GetCloseData(df,Start_Num)
            print(CheckPrice, "  <<-  df[-", Start_Num,"]")

            if Now_Price >= CheckPrice:
                print("UP!")
                Up_Count += 1.0


            Start_Num -= 10

        avg_10day_momentum_score = Up_Count/Avg_Period

        print("100ì¼ í‰ê·  ëª¨ë©˜í…€ ", avg_10day_momentum_score)





        Up_Count = 0
        Start_Num = -2
        for i in range(1,int(Avg_Period)+1):
            
            CheckPrice = Common.GetCloseData(df,Start_Num)
            print(CheckPrice, "  <<-  df[-", Start_Num,"]")

            if Now_Price >= CheckPrice:
                print("UP!")
                Up_Count += 1.0


            Start_Num -= 1

        avg_day_momentum_score = Up_Count/Avg_Period

        print("10ì¼ í‰ê·  ëª¨ë©˜í…€ ", avg_day_momentum_score)


        long_momentum_score = (avg_month_momentum_score * 0.3) + (avg_10day_momentum_score * 0.2) + (avg_day_momentum_score * 0.3)
        short_momentum_score = 0.8 - long_momentum_score

        #ì ˆëŒ€ ë¹„ì¤‘ì„ ë”í•´ì¤€ë‹¤.
        long_momentum_score += 0.1
        short_momentum_score += 0.1

        #ê²°êµ­ ë¡± ìŠ¤ì½”ì–´ì™€ ìˆ ìŠ¤ì½”ì–´ë¥¼ ë”í•˜ë©´ 1.0ì´ ë‚˜ì˜¨ë‹¤.

        print("ë¡± ëª¨ë©˜í…€ ìŠ¤ì½”ì–´:", long_momentum_score , "ìˆ ëª¨ë©˜í…€ ìŠ¤ì½”ì–´:", short_momentum_score)

        MomentumInfoDict['long_momentum_score'] = long_momentum_score
        MomentumInfoDict['short_momentum_score'] = short_momentum_score


        MomentumInfoDict['day_st'] = strday

        #íŒŒì¼ì— ì €ì¥
        if ENABLE_ORDER_EXECUTION == True:
            with open(status_file_path, 'w') as outfile:
                json.dump(MomentumInfoDict, outfile)


    pprint.pprint(MomentumInfoDict)










    #ê³„ì¢Œ ì”ê³ ë¥¼ ê°€ì§€ê³  ì˜¨ë‹¤!
    Balance = KisKR.GetBalance()
    #####################################################################################################################################

    '''-------í†µí•© ì¦ê±°ê¸ˆ ì‚¬ìš©ìëŠ” ì•„ë˜ ì½”ë“œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! -----------'''
    #í†µí•©ì¦ê±°ê¸ˆ ê³„ì¢Œ ì‚¬ìš©ì ë¶„ë“¤ì¤‘ ë§Œì•½ ë¯¸êµ­ê³„ì¢Œë‘ í†µí•©í•´ì„œ ì´ìì‚°ì„ ê³„ì‚° í•˜ê³  í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ì—ë„ ë°˜ì˜í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ ì•„ë˜ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì‹œë©´ ë˜ê³  ë‚˜ë¨¸ì§€ëŠ” ë™ì¼í•©ë‹ˆë‹¤!!!
    #Balance = Common.GetBalanceKrwTotal()

    '''-----------------------------------------------------------'''
    #####################################################################################################################################



    print("--------------ë‚´ ë³´ìœ  ì”ê³ ---------------------")

    pprint.pprint(Balance)

    print("--------------------------------------------")

    #ê¸°ì¤€ì´ ë˜ëŠ” ë‚´ ì´ í‰ê°€ê¸ˆì•¡ì—ì„œ íˆ¬ìë¹„ì¤‘ì„ ê³±í•´ì„œ ë‚˜ì˜¨ í¬íŠ¸í´ë¦¬ì˜¤ì— í• ë‹¹ëœ ëˆ!!
    TotalMoney = float(Balance['TotalMoney']) * InvestRate
    print("TotalMoney:", str(format(round(TotalMoney), ',')))

    #ë¡±ê³¼ ìˆì— í• ë‹¹ëœ íˆ¬ì ê¸ˆì•¡!
    Long_StockMoney = TotalMoney * MomentumInfoDict['long_momentum_score']
    Short_StockMoney = TotalMoney * MomentumInfoDict['short_momentum_score']
    print("Long_StockMoney:", str(format(round(Long_StockMoney), ',')))
    print("Short_StockMoney:", str(format(round(Short_StockMoney), ',')))

    #50ë¶„í• í•˜ì—¬ 1íšŒì°¨ íˆ¬ì ê¸ˆì•¡ í™•ì •!
    Long_StMoney = Long_StockMoney / 50.0
    Short_StMoney = Short_StockMoney / 50.0
    print("Long_StMoney:", str(format(round(Long_StMoney), ',')))
    print("Short_StMoney:", str(format(round(Short_StMoney), ',')))



    #íƒ€ê²Ÿ ìˆ˜ìµ ê¸ˆì•¡! ë‚´ ì´ ê¸ˆì•¡ì˜ 0.5%
    TargetRevenuMoney = (TotalMoney / 200.0)



    print("--------------ë‚´ ë³´ìœ  ì£¼ì‹---------------------")
    #ê·¸ë¦¬ê³  í˜„ì¬ ì´ ê³„ì¢Œì—ì„œ ë³´ìœ í•œ ì£¼ì‹ ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì§€ê³  ì˜µë‹ˆë‹¤!
    MyStockList = KisKR.GetMyStockList()
    pprint.pprint(MyStockList)
    print("--------------------------------------------")
        







    ################################### ë§¤ë„ íŒë‹¨ íŒŒíŠ¸ ###################################

    TotalRevenue = 0

    #íˆ¬ìí•  ì¢…ëª©ì„ ìˆœíšŒí•œë‹¤!
    for stock_code in TargetStockList:

        #ì£¼ì‹(ETF) ì •ë³´~
        stock_name = ""
        stock_amt = 0 #ìˆ˜ëŸ‰
        stock_avg_price = 0 #í‰ë‹¨
        stock_eval_totalmoney = 0 #ì´í‰ê°€ê¸ˆì•¡!
        stock_revenue_rate = 0 #ì¢…ëª© ìˆ˜ìµë¥ 
        stock_revenue_money = 0 #ì¢…ëª© ìˆ˜ìµê¸ˆ


        #ë§¤ìˆ˜ëœ ìƒíƒœë¼ë©´ ì •ë³´ë¥¼ ë„£ì–´ì¤€ë‹¤!!!
        for my_stock in MyStockList:
            if my_stock['StockCode'] == stock_code:
                stock_name = my_stock['StockName']
                stock_amt = int(my_stock['StockAmt'])
                stock_avg_price = float(my_stock['StockAvgPrice'])
                stock_eval_totalmoney = float(my_stock['StockNowMoney'])
                stock_revenue_rate = float(my_stock['StockRevenueRate'])
                stock_revenue_money = float(my_stock['StockRevenueMoney'])

                break

        #ë§¤ë§¤ì‹œ ìˆ˜ìˆ˜ë£Œë¥¼ ë³´ì •í•˜ê¸° ìœ„í•´ ì†ì‹¤ì€ ëŠ˜ë¦¬ê³  ìˆ˜ìµì€ ì¤„ì—¬ì¤€ë‹¤. (ì†ìµí™•ì •ê¸ˆì˜ 20%ë¥¼ ìˆ˜ìˆ˜ë£Œë° ì„¸ê¸ˆìœ¼ë¡œ ëŒ€ì¶© ì³ì£¼ì!)
        if stock_revenue_money < 0:
            stock_revenue_money *= 1.2
        else:
            stock_revenue_money *= 0.8

                
        TotalRevenue += stock_revenue_money #í˜„ì¬ ì¢…ëª© ìˆ˜ìµê¸ˆì„ ë”í•´ì¤€ë‹¤!!!

        #ì”ê³ ê°€ 0 ì´ìƒì´ë¼ë©´ ë°ì´í„°ë¥¼ ì²´í¬í•œë‹¤!
        if stock_amt > 0:

            #ì´ì œ ë°ì´í„°(InfinityMaDataList)ëŠ” í™•ì‹¤íˆ ìˆì„ í…Œë‹ˆ ë³¸ê²©ì ìœ¼ë¡œ íŠ¸ë ˆì´ë”©ì„ í•©ë‹ˆë‹¤!
            for StockInfo in InfinityMaDataList:

                if StockInfo['StockCode'] == stock_code:
                    TotalRevenue -= float(StockInfo['S_WaterLossMoney'])  #í˜„ì¬ ëˆ„ì ëœ ì†ì‹¤ê¸ˆì„ ë¹¼ì¤€ë‹¤!
                    break
    

    print("ëª©í‘œ ìˆ˜ìµ : ", TargetRevenuMoney)
    print("í˜„ì¬ ì†ìµ : ", TotalRevenue)

            
            
    IsSellAll = False
    #ì¢…ëª© ìˆ˜ìµê¸ˆì˜ í•©ì— ëˆ„ì ì†ì‹¤ê¸ˆì„ ì œí•œ ìˆœ ìˆ˜ìµê°’ì´ ëª©í‘œí•œ ìˆ˜ìµê¸ˆë³´ë‹¤ í¬ë©´!!! ì´ë“ì„ ë´¤ë‹¤ ëª¨ë‘ íŒ”ê³  ì¢…ë£Œ!!!
    if TargetRevenuMoney < TotalRevenue:
        IsSellAll = True

        print("ëª©í‘œ ìˆ˜ìµ ë‹¬ì„±!! ëª¨ë‘ ì •ë¦¬!!")

            


    ################################### ë§¤ìˆ˜ íŒŒíŠ¸ ###################################


    #íˆ¬ìí•  ì¢…ëª©ì„ ìˆœíšŒí•œë‹¤!
    for stock_code in TargetStockList:


        #ì£¼ì‹(ETF) ì •ë³´~
        stock_name = ""
        stock_amt = 0 #ìˆ˜ëŸ‰
        stock_avg_price = 0 #í‰ë‹¨
        stock_eval_totalmoney = 0 #ì´í‰ê°€ê¸ˆì•¡!
        stock_revenue_rate = 0 #ì¢…ëª© ìˆ˜ìµë¥ 
        stock_revenue_money = 0 #ì¢…ëª© ìˆ˜ìµê¸ˆ


        #ë§¤ìˆ˜ëœ ìƒíƒœë¼ë©´ ì •ë³´ë¥¼ ë„£ì–´ì¤€ë‹¤!!!
        for my_stock in MyStockList:
            if my_stock['StockCode'] == stock_code:
                stock_name = my_stock['StockName']
                stock_amt = int(my_stock['StockAmt'])
                stock_avg_price = float(my_stock['StockAvgPrice'])
                stock_eval_totalmoney = float(my_stock['StockNowMoney'])
                stock_revenue_rate = float(my_stock['StockRevenueRate'])
                stock_revenue_money = float(my_stock['StockRevenueMoney'])

                break
                

                

        #ë§¤ë§¤ì‹œ ìˆ˜ìˆ˜ë£Œë¥¼ ë³´ì •í•˜ê¸° ìœ„í•´ ì†ì‹¤ì€ ëŠ˜ë¦¬ê³  ìˆ˜ìµì€ ì¤„ì—¬ì¤€ë‹¤. (ì†ìµí™•ì •ê¸ˆì˜ 20%ë¥¼ ìˆ˜ìˆ˜ë£Œë° ì„¸ê¸ˆìœ¼ë¡œ ëŒ€ì¶© ì³ì£¼ì!)
        if stock_revenue_money < 0:
            stock_revenue_money *= 1.2
        else:
            stock_revenue_money *= 0.8


        #í˜„ì¬ê°€
        CurrentPrice = KisKR.GetCurrentPrice(stock_code)



            
        #ì¢…ëª© ë°ì´í„°
        PickStockInfo = None

        #ì €ì¥ëœ ì¢…ëª© ë°ì´í„°ë¥¼ ì°¾ëŠ”ë‹¤
        for StockInfo in InfinityMaDataList:
            if StockInfo['StockCode'] == stock_code:
                PickStockInfo = StockInfo
                break

        #PickStockInfo ì´ê²Œ ì—†ë‹¤ë©´ ë§¤ìˆ˜ë˜ì§€ ì•Šì€ ì²˜ìŒ ìƒíƒœì´ê±°ë‚˜ ì´ì „ì— ì†ìœ¼ë¡œ ë§¤ìˆ˜í•œ ì¢…ëª©ì¸ë° í•´ë‹¹ ë´‡ìœ¼ë¡œ ëŒë¦¬ê³ ì í•  ë•Œ!
        if PickStockInfo == None:
            #ì”ê³ ê°€ ì—†ë‹¤ ì¦‰ ì²˜ìŒì´ë‹¤!!!
            if stock_amt == 0:

                InfinityDataDict = dict()
                
                InfinityDataDict['StockCode'] = stock_code #ì¢…ëª© ì½”ë“œ
                InfinityDataDict['Round'] = 0    #í˜„ì¬ íšŒì°¨
                InfinityDataDict['IsReady'] = 'Y' #í•˜ë£¨ì— í•œë²ˆ ì²´í¬í•˜ê³  ë§¤ìˆ˜ë“±ì˜ ì²˜ë¦¬ë¥¼ í•˜ê¸° ìœ„í•œ í”Œë˜ê·¸

                InfinityDataDict['S_WaterAmt'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰!
                InfinityDataDict['S_WaterLossMoney'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰ì„ íŒ”ë•Œ ì†í•´ë³¸ ê¸ˆì•¡

                InfinityMaDataList.append(InfinityDataDict) #ë°ì´í„°ë¥¼ ì¶”ê°€ í•œë‹¤!


                msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ ì–‘ë°©í–¥ ì‹œì‘!!!!"
                print(msg) 
                line_alert.SendMessage(msg) 
                
         
            #ë°ì´í„°ê°€ ì—†ëŠ”ë° ì”ê³ ê°€ ìˆë‹¤? ì´ë¯¸ ì´ ë´‡ìœ¼ë¡œ íŠ¸ë ˆì´ë”© í•˜ê¸°ì „ì— ë§¤ìˆ˜ëœ ì¢…ëª©!
            else:
                print("Exist")

                InfinityDataDict = dict()
                
                InfinityDataDict['StockCode'] = stock_code #ì¢…ëª© ì½”ë“œ

                if stock_code == LongStockCode:
                    InfinityDataDict['Round'] = int(stock_eval_totalmoney / Long_StMoney)    #í˜„ì¬ íšŒì°¨ - ë§¤ìˆ˜ëœ ê¸ˆì•¡ì„ 50ë¶„í• ëœ ë‹¨ìœ„ ê¸ˆì•¡ìœ¼ë¡œ ë‚˜ëˆ„ë©´ íšŒì°¨ê°€ ë‚˜ì˜¨ë‹¤!
                else:
                    InfinityDataDict['Round'] = int(stock_eval_totalmoney / Short_StMoney)    #í˜„ì¬ íšŒì°¨ - ë§¤ìˆ˜ëœ ê¸ˆì•¡ì„ 50ë¶„í• ëœ ë‹¨ìœ„ ê¸ˆì•¡ìœ¼ë¡œ ë‚˜ëˆ„ë©´ íšŒì°¨ê°€ ë‚˜ì˜¨ë‹¤!

                InfinityDataDict['IsReady'] = 'Y' #í•˜ë£¨ì— í•œë²ˆ ì²´í¬í•˜ê³  ë§¤ìˆ˜ë“±ì˜ ì²˜ë¦¬ë¥¼ í•˜ê¸° ìœ„í•œ í”Œë˜ê·¸

                InfinityDataDict['S_WaterAmt'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰!
                InfinityDataDict['S_WaterLossMoney'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰ì„ íŒ”ë•Œ ì†í•´ë³¸ ê¸ˆì•¡


                InfinityMaDataList.append(InfinityDataDict) #ë°ì´í„°ë¥¼ ì¶”ê°€ í•œë‹¤!


                msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  ê¸°ì¡´ì— ë§¤ìˆ˜í•œ ì¢…ëª©ì„ ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ìœ¼ë¡œ ë³€ê²½í•´ì„œ íŠ¸ë ˆì´ë”© ì²« ì‹œì‘!!!! " + str(InfinityDataDict['Round']) + "íšŒì°¨ë¡œ ì„¸íŒ… ì™„ë£Œ!"
                print(msg) 
                line_alert.SendMessage(msg) 
           
            if ENABLE_ORDER_EXECUTION == True:
                #íŒŒì¼ì— ì €ì¥
                with open(bot_file_path, 'w') as outfile:
                    json.dump(InfinityMaDataList, outfile)
                    




        #ì´ì œ ë°ì´í„°(InfinityMaDataList)ëŠ” í™•ì‹¤íˆ ìˆì„ í…Œë‹ˆ ë³¸ê²©ì ìœ¼ë¡œ íŠ¸ë ˆì´ë”©ì„ í•©ë‹ˆë‹¤!
        for StockInfo in InfinityMaDataList:

            if StockInfo['StockCode'] == stock_code:

                if IsSellAll == True:

                    if stock_amt > 0 and StockInfo['Round'] > 0:

                        if ENABLE_ORDER_EXECUTION == True:

                            #ëª¨ë‘ ì •ë¦¬í•©ë‹ˆë‹¤.
                            pprint.pprint(KisKR.MakeSellMarketOrder(stock_code,stock_amt))


                            msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ ëª¨ë‘ íŒ”ì•„ì„œ ì†ìµí™•ì •!!!!  [" + str(stock_revenue_money) + "] ì†ìµ ì¡°ìœ¼ë‹¤! (í˜„ì¬ [" + str(StockInfo['Round']) + "] ë¼ìš´ë“œê¹Œì§€ ì§„í–‰ë˜ì—ˆê³  ëª¨ë“  ìˆ˜ëŸ‰ ë§¤ë„ ì²˜ë¦¬! )"
                            print(msg) 
                            line_alert.SendMessage(msg) 

                            #ì „ëŸ‰ ë§¤ë„ ëª¨ë‘ ì´ˆê¸°í™”! 
                            StockInfo['Round'] = 0
                            StockInfo['IsReady'] = 'N' #ìµì ˆí•œ ë‚ ì€ ë§¤ìˆ˜ ì•ˆí•˜ê³  ì¦ê¸°ì!
                            StockInfo['S_WaterAmt'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰ ì´ˆê¸°í™” 
                            StockInfo['S_WaterLossMoney'] = 0 #ë¬¼íƒ„ ìˆ˜ëŸ‰ì„ íŒ”ë•Œ ì†í•´ë³¸ ê¸ˆì•¡ ì´ˆê¸°í™”!

                        else:
                            print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")

                else:


                    #ë§¤ìˆ˜ëŠ” ì¥ì´ ì—´ë ¸ì„ ë•Œ 1ë²ˆë§Œ í•´ì•¼ ë˜ë‹ˆê¹! ì•ˆì˜ ë¡œì§ì„ ë‹¤ ìˆ˜í–‰í•˜ë©´ Nìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤! 
                    if StockInfo['IsReady'] == 'Y':

                        #ë¡±ì¼ ê²½ìš°!
                        if stock_code == LongStockCode:
                            StockInfo['Round'] = int(stock_eval_totalmoney / Long_StMoney)  
                        else:
                            StockInfo['Round'] = int(stock_eval_totalmoney / Short_StMoney)  



                        Is_Cut_Ok = False

                        if stock_code == LongStockCode:
                             #5ì¼ì„  ë°‘ì— ìˆëŠ” í•˜ë½ì„¸ë‹¤!!!
                            if MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price'] and StockInfo['Round'] >= 1.0:
                                Is_Cut_Ok = True
                                if MomentumInfoDict['long_momentum_score'] > MomentumInfoDict['short_momentum_score']:
                                    if StockInfo['Round'] < 5.0:
                                        Is_Cut_Ok = False
                        else:
                            #5ì¼ì„  ìœ„ì— ìˆëŠ” ìƒìŠ¹ì„¸ë‹¤!!!
                            if MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price'] and StockInfo['Round'] >= 1.0:
                                Is_Cut_Ok = True
                                if MomentumInfoDict['long_momentum_score'] < MomentumInfoDict['short_momentum_score']:
                                    if StockInfo['Round'] < 5.0:
                                        Is_Cut_Ok = False
                            


                        if Is_Cut_Ok == True:
                                

                            StMoney = Long_StMoney

                            if stock_code == ShortStockCode:
                                StMoney = Short_StMoney


                            SellAmt = float(StMoney) / float(CurrentPrice)
                            
     
                            if SellAmt < 1.0:
                                SellAmt = 1.0

                            StockInfo['Round'] -= 1.0

                            if stock_amt > 0:

                                if ENABLE_ORDER_EXECUTION == True:
        
                                    pprint.pprint(KisKR.MakeSellMarketOrder(stock_code,SellAmt))

                                    #ë‹¨ í˜„ì¬ ìˆ˜ìµê¸ˆì´ ë§ˆì´ë„ˆìŠ¤ ì¦‰ ì†ì‹¤ ìƒíƒœë¼ë©´ ì†ì‹¤ ê¸ˆì•¡ì„ ì €ì¥í•´ ë‘”ë‹¤!
                                    if stock_revenue_money < 0:
                                        #ì†ì‹¤ ê¸ˆì•¡ì—ì„œ ë§¤ë„ìˆ˜ëŸ‰/ë³´ìœ ìˆ˜ëŸ‰ ì¦‰ ì˜ˆë¡œ 10ê°œë³´ìœ  í•˜ê³  í˜„ì¬ -100ë‹¬ëŸ¬ì¸ë° 3ê°œë¥¼ íŒŒëŠ” ê±°ë¼ë©´ ì‹¤ì œ í™•ì • ì†ì‹¤ê¸ˆì€ -100 * (3/10)ì´ ë‹ˆê¹~
                                        LossMoney = abs(stock_revenue_money) * (float(SellAmt) / float(stock_amt))
                                        StockInfo['S_WaterLossMoney'] += LossMoney

                                        msg = stock_code + " 5ì¼ì„  ê¸°ì¤€ 1íšŒì°¨ ë§¤ë„í•©ë‹ˆë‹¤! ì•½ [" + str(LossMoney) + "] í™•ì •ì†ì‹¤ì´ ë‚˜ì„œ ê¸°ë¡í–ˆìœ¼ë©° ëˆ„ì  ì†ì‹¤ì€ [" + str(StockInfo['S_WaterLossMoney']) + "] ì…ë‹ˆë‹¤"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 

                                    #ì´ ê²½ìš°ëŠ” ì´ë“ ë³¸ ê²½ìš°ë‹¤!
                                    else:

                                        #ì´ë“ë³¸ ê¸ˆì•¡ë„ ê³„ì‚°í•´ë³´ì
                                        RevenuMoney = abs(stock_revenue_money) * (float(SellAmt) / float(stock_amt))

                                        #í˜¹ì‹œë‚˜ ì €ì¥ëœ ì†ì‹¤ë³¸ ê¸ˆì•¡ì´ ìˆë‹¤ë©´ ì¤„ì—¬ ì¤€ë‹¤! (ë¹ ë¥¸ íƒˆì¶œì„ ìœ„í•´)
                                        if StockInfo['S_WaterLossMoney'] > 0:
                                            StockInfo['S_WaterLossMoney'] -= RevenuMoney #ì € ë°ì´í„°ëŠ” ì†ì‹¤ê¸ˆì„ ì €ì¥í•˜ëŠ” ê³³ì´ë‹ˆ ë¹¼ì¤€ë‹¤

                                            #ìˆ˜ìµê¸ˆì„ ëºë”ë‹ˆ ì†ì‹¤ê¸ˆì´ ìŒìˆ˜ë¼ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬í•´ ì¤€ë‹¤!
                                            #if StockInfo['S_WaterLossMoney'] < 0:
                                            #    StockInfo['S_WaterLossMoney'] = 0


                                        msg = stock_code + " 5ì¼ì„  ê¸°ì¤€ 1íšŒì°¨ ë§¤ë„í•©ë‹ˆë‹¤! ! ì•½ [" + str(RevenuMoney) + "] í™•ì • ìˆ˜ìµì´ ë‚¬ë„¤ìš”!"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 


                                else:
                                    print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")
                                
                        #40íšŒë¥¼ ë„˜ì—ˆë‹¤ë©´! í’€ë§¤ìˆ˜ ìƒíƒœì´ë‹¤!
                        if StockInfo['Round'] >= 40:

                            Need_Cut = False
                            if stock_code == LongStockCode:
                                #ê·¸ëŸ°ë° ì• ì‹œë‹¹ì´ˆ í›„ë°˜ë¶€ëŠ” 5ì¼ì„ ì´ ì¦ê°€ì¶”ì„¸ì¼ë•Œë§Œ ë§¤ë§¤ í•˜ë¯€ë¡œ 5ì¼ì„ ì´ í•˜ë½ìœ¼ë¡œ ë°”ë€Œì—ˆë‹¤ë©´ ì´ë•Œ ì†ì ˆì²˜ë¦¬ë¥¼ í•œë‹¤
                                if MomentumInfoDict['Ma5_before'] > MomentumInfoDict['Ma5']:
                                    Need_Cut = True
                            else:
                                #ìˆì€ ì• ì‹œë‹¹ì´ˆ í›„ë°˜ë¶€ëŠ” 5ì¼ì„ ì´ ê°ì†Œ ì¶”ì„¸ì¼ë•Œë§Œ ë§¤ë§¤ í•˜ë¯€ë¡œ 5ì¼ì„ ì´ ìƒìŠ¹ ë°”ë€Œì—ˆë‹¤ë©´ ì´ë•Œ ì†ì ˆì²˜ë¦¬ë¥¼ í•œë‹¤
                                if MomentumInfoDict['Ma5_before'] < MomentumInfoDict['Ma5']:
                                    Need_Cut = True

                            
                            if Need_Cut == True:
                                #ì ˆë°˜ì„ ì†ì ˆì²˜ë¦¬ í•œë‹¤
    
                                #ì ˆë°˜ì€ ë°”ë¡œ íŒ”ê³  ì ˆë°˜ì€ íŠ¸ë ˆì¼ë§ ìŠ¤íƒ‘ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤!!!
                                HalfAmt = int(stock_amt * 0.5)

                                if ENABLE_ORDER_EXECUTION == True:

                                    #ì ˆë°˜ë§Œ íŒë‹ˆë‹¤!!!!!
                                    pprint.pprint(KisKR.MakeSellMarketOrder(stock_code,HalfAmt))

                                    StockInfo['Round'] = 21 #ë¼ìš´ë“œëŠ” ì ˆë°˜ì„ íŒ”ì•˜ìœ¼ë‹ˆê¹ 21íšŒë¡œ ì´ˆê¸°í™”

                                    #ë‹¨ í˜„ì¬ ìˆ˜ìµê¸ˆì´ ë§ˆì´ë„ˆìŠ¤ ì¦‰ ì†ì‹¤ ìƒíƒœë¼ë©´ ì†ì‹¤ ê¸ˆì•¡ì„ ì €ì¥í•´ ë‘”ë‹¤!
                                    if stock_revenue_money < 0:
                                        #ì†ì‹¤ ê¸ˆì•¡ì—ì„œ ë§¤ë„ìˆ˜ëŸ‰/ë³´ìœ ìˆ˜ëŸ‰ ì¦‰ ì˜ˆë¡œ 10ê°œë³´ìœ  í•˜ê³  í˜„ì¬ -100ë‹¬ëŸ¬ì¸ë° 5ê°œë¥¼ íŒŒëŠ” ê±°ë¼ë©´ ì‹¤ì œ í™•ì • ì†ì‹¤ê¸ˆì€ -100 * (5/10)ì´ ë‹ˆê¹~
                                        LossMoney = abs(stock_revenue_money) * (float(HalfAmt) / float(stock_amt))
                                        StockInfo['S_WaterLossMoney'] += LossMoney

                                        msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  40íšŒê°€ ì†Œì§„ë˜ì–´ ì ˆë°˜ ì†ì ˆí•©ë‹ˆë‹¤! ì•½ [" + str(LossMoney) + "] í™•ì •ì†ì‹¤ì´ ë‚˜ì„œ ê¸°ë¡í–ˆìœ¼ë©° ëˆ„ì  ì†ì‹¤ì€ [" + str(StockInfo['S_WaterLossMoney']) + "] ì…ë‹ˆë‹¤"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 

                                    #ì´ ê²½ìš°ëŠ” ì´ë“ ë³¸ ê²½ìš°ë‹¤! ëª©í‘œ %ì— ëª» ë„ë‹¬í–ˆì§€ë§Œ ìˆ˜ìµê¶Œì´ê¸´ í•œ ìƒíƒœ.
                                    else:

                                        #ì´ë“ë³¸ ê¸ˆì•¡ë„ ê³„ì‚°í•´ë³´ì
                                        RevenuMoney = abs(stock_revenue_money) * (float(HalfAmt) / float(stock_amt))

                                        #í˜¹ì‹œë‚˜ ì €ì¥ëœ ì†ì‹¤ë³¸ ê¸ˆì•¡ì´ ìˆë‹¤ë©´ ì¤„ì—¬ ì¤€ë‹¤! (ë¹ ë¥¸ íƒˆì¶œì„ ìœ„í•´)
                                        if StockInfo['S_WaterLossMoney'] > 0:
                                            StockInfo['S_WaterLossMoney'] -= RevenuMoney #ì € ë°ì´í„°ëŠ” ì†ì‹¤ê¸ˆì„ ì €ì¥í•˜ëŠ” ê³³ì´ë‹ˆ ë¹¼ì¤€ë‹¤

                                            #ìˆ˜ìµê¸ˆì„ ëºë”ë‹ˆ ì†ì‹¤ê¸ˆì´ ìŒìˆ˜ë¼ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬í•´ ì¤€ë‹¤!
                                            #if StockInfo['S_WaterLossMoney'] < 0:
                                            #    StockInfo['S_WaterLossMoney'] = 0


                                        msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  40íšŒê°€ ì†Œì§„ë˜ì–´ ì ˆë°˜ ë§¤ë„í•©ë‹ˆë‹¤! ì•½ [" + str(RevenuMoney) + "] í™•ì • ìˆ˜ìµì´ ë‚¬ë„¤ìš”!"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 
                                else:
                                    print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")

                        '''
                        
                        1~10íšŒ:

                        ë¬´ì¡°ê±´ ì‚½ë‹ˆë‹¤

                        11~20íšŒ :

                        5ì¼ì„  ìœ„ì— ìˆì„ ë•Œë§Œ!

                        21~30íšŒ :

                        5ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ë´‰ì´ ì–‘ë´‰ì¼ë•Œë§Œ

                        30~40íšŒ :

                        5ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ë´‰ì´ ì–‘ë´‰ì´ê³  
                        5ì¼ì„  ì¦ê°€, 20ì¼ì„ ì´ ì¦ê°€í–ˆë‹¤!

                        '''

                        IsBuyGo = False #ë§¤ìˆ˜ í•˜ëŠ”ì§€!

                        #ë¡±ì¼ ê²½ìš°!
                        if stock_code == LongStockCode:

                            #ë¼ìš´ë“œì— ë”°ë¼ ë§¤ìˆ˜ ì¡°ê±´ì´ ë‹¤ë¥´ë‹¤!
                            if StockInfo['Round'] <= 5-1:

                                #ë¡± ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] > MomentumInfoDict['short_momentum_score']:

                                    #ì—¬ê¸°ëŠ” ë¬´ì¡°ê±´ ë§¤ìˆ˜
                                    IsBuyGo = True
                                
                                else:
                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  ìœ„ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price']:
                                        IsBuyGo = True

                            elif StockInfo['Round'] <= 20-1:


                                #ë¡± ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] > MomentumInfoDict['short_momentum_score']:
                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  ìœ„ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price']:
                                        IsBuyGo = True
                                else:
                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  / 20ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ ë´‰ì´ ì–‘ë´‰ì¼ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 1:
                                        IsBuyGo = True                   



                            elif StockInfo['Round'] <= 30-1:


                                #ë¡± ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] > MomentumInfoDict['short_momentum_score']:

                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ ë´‰ì´ ì–‘ë´‰ì¼ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 1:
                                        IsBuyGo = True
                                else:

                                    #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ ë´‰ì´ ì–‘ë´‰ì¼ë•Œ ê·¸ë¦¬ê³  5ì¼ì„ , 20ì¼ì„  ë‘˜ë‹¤ ì¦ê°€ì¶”ì„¸ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 1 and MomentumInfoDict['Ma5_before'] < MomentumInfoDict['Ma5'] and MomentumInfoDict['Ma20_before'] < MomentumInfoDict['Ma20']:
                                        IsBuyGo = True


                            elif StockInfo['Round'] <= 40-1:

                                #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ìœ„ì— ìˆê³  ì´ì „ ë´‰ì´ ì–‘ë´‰ì¼ë•Œ ê·¸ë¦¬ê³  5ì¼ì„ , 20ì¼ì„  ë‘˜ë‹¤ ì¦ê°€ì¶”ì„¸ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                if MomentumInfoDict['Ma20'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] < MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 1 and MomentumInfoDict['Ma5_before'] < MomentumInfoDict['Ma5'] and MomentumInfoDict['Ma20_before'] < MomentumInfoDict['Ma20']:
                                    IsBuyGo = True
                        #ìˆì¼ ê²½ìš°
                        else:

                            #ë¼ìš´ë“œì— ë”°ë¼ ë§¤ìˆ˜ ì¡°ê±´ì´ ë‹¤ë¥´ë‹¤!
                            if StockInfo['Round'] <= 5-1:
                                #ìˆ ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] < MomentumInfoDict['short_momentum_score']:

                                    #ì—¬ê¸°ëŠ” ë¬´ì¡°ê±´ ë§¤ìˆ˜
                                    IsBuyGo = True

                                else:
                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  ì•„ë˜ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price']:
                                        IsBuyGo = True


                            elif StockInfo['Round'] <= 20-1:
                                #ìˆ ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] < MomentumInfoDict['short_momentum_score']:

                                    #í˜„ì¬ê°€ê°€ 5ì¼ì„  ì•„ë˜ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price']:
                                        IsBuyGo = True

                                else:

                                    #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ì•„ë˜ì— ìˆê³  ì´ì „ ë´‰ì´ ìŒë´‰ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 0:
                                        IsBuyGo = True

                            elif StockInfo['Round'] <= 30-1:
                                #ìˆ ëª¨ë©˜í…€ì´ ìš°ì„¸í•˜ë‹¤ë©´! ê¸°ì¡´ëŒ€ë¡œ!
                                if MomentumInfoDict['long_momentum_score'] < MomentumInfoDict['short_momentum_score']:

                                    #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ì•„ë˜ì— ìˆê³  ì´ì „ ë´‰ì´ ìŒë´‰ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 0:
                                        IsBuyGo = True

                                else:

                                    #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ì•„ë˜ì— ìˆê³  ì´ì „ ë´‰ì´ ìŒë´‰ ë•Œ ê·¸ë¦¬ê³  5ì¼ì„ , 20ì¼ì„  ë‘˜ë‹¤ ê°ì†Œ ì¶”ì„¸ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                    if MomentumInfoDict['Ma20'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 0 and MomentumInfoDict['Ma5_before'] > MomentumInfoDict['Ma5'] and MomentumInfoDict['Ma20_before'] > MomentumInfoDict['Ma20']:
                                        IsBuyGo = True

                            elif StockInfo['Round'] <= 40-1:

                                #í˜„ì¬ê°€ê°€ 5/20ì¼ì„  ì•„ë˜ì— ìˆê³  ì´ì „ ë´‰ì´ ìŒë´‰ ë•Œ ê·¸ë¦¬ê³  5ì¼ì„ , 20ì¼ì„  ë‘˜ë‹¤ ê°ì†Œ ì¶”ì„¸ì— ìˆì„ ë•Œë§Œ ë§¤ìˆ˜
                                if MomentumInfoDict['Ma20'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['Ma5'] > MomentumInfoDict['Now_Price'] and MomentumInfoDict['IsUpCandle'] == 0 and MomentumInfoDict['Ma5_before'] > MomentumInfoDict['Ma5'] and MomentumInfoDict['Ma20_before'] > MomentumInfoDict['Ma20']:
                                    IsBuyGo = True



                        #í•œ íšŒì°¨ ë§¤ìˆ˜ í•œë‹¤!!
                        if IsBuyGo == True:

                            if ENABLE_ORDER_EXECUTION == True:

                                StMoney = Long_StMoney

                                if stock_code == ShortStockCode:
                                    StMoney = Short_StMoney


                                BuyAmt = float(StMoney) / float(CurrentPrice)
                                
                                #1ì£¼ë³´ë‹¤ ì ë‹¤ë©´ íˆ¬ìê¸ˆì´ë‚˜ íˆ¬ìë¹„ì¤‘ì´ ì‘ì€ ìƒí™©ì¸ë° ì¼ë‹¨ 1ì£¼ëŠ” ë§¤ìˆ˜í•˜ê²Œë” ì²˜ë¦¬ í•˜ì!
                                if BuyAmt < 1.0:
                                    BuyAmt = 1

                                    StockInfo['Round'] += (float(CurrentPrice)/float(StMoney))
                                else:
                                    StockInfo['Round'] += 1 #ë¼ìš´ë“œ ì¦ê°€!

                                #ì‹œì¥ê°€ ì£¼ë¬¸ì„ ë„£ëŠ”ë‹¤!
                                #í˜„ì¬ê°€ë³´ë‹¤ ìœ„ì— ë§¤ìˆ˜ ì£¼ë¬¸ì„ ë„£ìŒìœ¼ë¡œì¨ ì‹œì¥ê°€ë¡œ ë§¤ìˆ˜!
                                pprint.pprint(KisKR.MakeBuyMarketOrder(stock_code,int(BuyAmt)))


                                msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ " + str(StockInfo['Round']) + "íšŒì°¨ ë§¤ìˆ˜ ì™„ë£Œ!"
                                print(msg) 
                                line_alert.SendMessage(msg) 
                            else:
                                print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")




                        ####################################################################################
                        ################## ìœ„ ì •ê·œ ë§¤ìˆ˜ ë¡œì§ê³¼ëŠ” ë³„ê°œë¡œ íŠ¹ë³„ ë¬¼íƒ€ê¸° ë¡œì§ì„ ì²´í¬í•˜ê³  ì œì–´í•œë‹¤! #############

                        #ì´í‰ì„ ì´ êº¾ì—¬ì„œ íŠ¹ë³„íˆ ë¬¼íƒ„ ê²½ìš° ìˆ˜ëŸ‰ì´ 0ì´ ì•„ë‹êº¼ê³  ì¦‰ ì—¬ê¸°ëŠ”  ë¬¼ì„ íƒ„ ìƒíƒœì´ë‹¤!
                        if StockInfo['S_WaterAmt'] != 0:
                            
                            if stock_amt >= 1:

                                if stock_amt < StockInfo['S_WaterAmt']:
                                    StockInfo['S_WaterAmt'] = stock_amt


                                if ENABLE_ORDER_EXECUTION == True:
                                    
                                    #í˜„ì¬ê°€ë³´ë‹¤ ì•„ë˜ì— ë§¤ë„ ì£¼ë¬¸ì„ ë„£ìŒìœ¼ë¡œì¨ ì‹œì¥ê°€ë¡œ ë§¤ë„íš¨ê³¼!
                                    pprint.pprint(KisKR.MakeSellMarketOrder(stock_code,StockInfo['S_WaterAmt']))

                                    #ë‹¨ í˜„ì¬ ìˆ˜ìµê¸ˆì´ ë§ˆì´ë„ˆìŠ¤ ì¦‰ ì†ì‹¤ ìƒíƒœë¼ë©´ ì†ì‹¤ ê¸ˆì•¡ì„ ì €ì¥í•´ ë‘”ë‹¤!
                                    if stock_revenue_money < 0:
                                        #ì†ì‹¤ ê¸ˆì•¡ì—ì„œ ë§¤ë„ìˆ˜ëŸ‰/ë³´ìœ ìˆ˜ëŸ‰ ì¦‰ ì˜ˆë¡œ 10ê°œë³´ìœ  í•˜ê³  í˜„ì¬ -100ë‹¬ëŸ¬ì¸ë° 3ê°œë¥¼ íŒŒëŠ” ê±°ë¼ë©´ ì‹¤ì œ í™•ì • ì†ì‹¤ê¸ˆì€ -100 * (3/10)ì´ ë‹ˆê¹~
                                        LossMoney = abs(stock_revenue_money) * (float(StockInfo['S_WaterAmt']) / float(stock_amt))
                                        StockInfo['S_WaterLossMoney'] += LossMoney

                                        msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  í‰ë‹¨ì„ í™• ë‚®ì¶”ê¸° ìœ„í•œ ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ ë¬¼íƒ„ì§€ í•˜ë£¨ê°€ ì§€ë‚˜ ê·¸ ìˆ˜ëŸ‰ë§Œí¼ ë§¤ë„í•©ë‹ˆë‹¤! ì•½ [" + str(LossMoney) + "] í™•ì •ì†ì‹¤ì´ ë‚˜ì„œ ê¸°ë¡í–ˆìœ¼ë©° ëˆ„ì  ì†ì‹¤ì€ [" + str(StockInfo['S_WaterLossMoney']) + "] ì…ë‹ˆë‹¤"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 

                                    #ì´ ê²½ìš°ëŠ” ì´ë“ ë³¸ ê²½ìš°ë‹¤!
                                    else:

                                        #ì´ë“ë³¸ ê¸ˆì•¡ë„ ê³„ì‚°í•´ë³´ì
                                        RevenuMoney = abs(stock_revenue_money) * (float(StockInfo['S_WaterAmt']) / float(stock_amt))

                                        #í˜¹ì‹œë‚˜ ì €ì¥ëœ ì†ì‹¤ë³¸ ê¸ˆì•¡ì´ ìˆë‹¤ë©´ ì¤„ì—¬ ì¤€ë‹¤! (ë¹ ë¥¸ íƒˆì¶œì„ ìœ„í•´)
                                        if StockInfo['S_WaterLossMoney'] > 0:
                                            StockInfo['S_WaterLossMoney'] -= RevenuMoney #ì € ë°ì´í„°ëŠ” ì†ì‹¤ê¸ˆì„ ì €ì¥í•˜ëŠ” ê³³ì´ë‹ˆ ë¹¼ì¤€ë‹¤

                                            #ìˆ˜ìµê¸ˆì„ ëºë”ë‹ˆ ì†ì‹¤ê¸ˆì´ ìŒìˆ˜ë¼ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬í•´ ì¤€ë‹¤!
                                            #if StockInfo['S_WaterLossMoney'] < 0:
                                            #    StockInfo['S_WaterLossMoney'] = 0


                                        msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  í‰ë‹¨ì„ í™• ë‚®ì¶”ê¸° ìœ„í•œ ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ ë¬¼íƒ„ì§€ í•˜ë£¨ê°€ ì§€ë‚˜ ê·¸ ìˆ˜ëŸ‰ë§Œí¼ ë§¤ë„í•©ë‹ˆë‹¤! ì•½ [" + str(RevenuMoney) + "] í™•ì • ìˆ˜ìµì´ ë‚¬ë„¤ìš”!"
                                        print(msg) 
                                        line_alert.SendMessage(msg) 

                                    StockInfo['S_WaterAmt'] = 0 #íŒ”ì•˜ìœ¼ë‹ˆ 0ìœ¼ë¡œ ì´ˆê¸°í™”!
                                else:
                                    print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")
                            
                        #í‰ë‹¨ ë‚®ì¶”ê¸°ìœ„í•œ ë¬¼íƒ€ê¸° ë¯¸ì§„í–‰!
                        else:

                            Water_Go = False
                            #ë¡±ì¼ ê²½ìš°!
                            if stock_code == LongStockCode:
                                # 20ì„ ë°‘ì— 5ì¼ì„ ì´ ìˆëŠ”ë° 5ì¼ì„ ì´ ìœ„ë¡œ êº¾ì—¬ì„ ë•Œ
                                if MomentumInfoDict['Ma5'] < MomentumInfoDict['Ma20'] and MomentumInfoDict['Ma5_before3'] > MomentumInfoDict['Ma5_before'] and MomentumInfoDict['Ma5_before'] < MomentumInfoDict['Ma5']:
                                    Water_Go = True
                            #ìˆì¼ ê²½ìš°!
                            else:
                                # 20ì„ ìœ„ì— 5ì¼ì„ ì´ ìˆëŠ”ë° 5ì¼ì„ ì´ ì•„ë˜ë¡œ êº¾ì—¬ì„ ë•Œ
                                if MomentumInfoDict['Ma5'] > MomentumInfoDict['Ma20'] and MomentumInfoDict['Ma5_before3'] < MomentumInfoDict['Ma5_before'] and MomentumInfoDict['Ma5_before'] > MomentumInfoDict['Ma5']:
                                    Water_Go = True

                           
                            if Water_Go == True and StockInfo['Round'] > 1:
                                
                                if ENABLE_ORDER_EXECUTION == True:
                                    '''

                                    ë§¤ìˆ˜í•  íšŒì°¨ = í˜„ì¬ íšŒì°¨ / 4 + 1

                                    '''
                                    #ì¦‰ 10ë¶„í•  ë‚¨ì€ ìˆ˜ëŸ‰ì„ íšŒì°¨ë¹„ì¤‘ë³„ë¡œ ì°¨ë“± ë¬¼ì„ íƒ„ë‹¤
                                    #ë§Œì•½ í˜„ì¬ 4íšŒì°¨ ì§„ì…ì— ì´ ìƒí™©ì„ ë§Œë‚¬ë‹¤ë©´ 2ë¶„í• ì„ ë¬¼ì„ íƒ€ì£¼ê³ 
                                    #ë§Œì•½ í˜„ì¬ 38íšŒì°¨ ì§„ì…ì— ì´ ìƒí™©ì„ ë§Œë‚¬ë‹¤ë©´ 10ë¶„í• ë¡œ ë¬¼ì„ íƒ€ì¤˜ì„œ
                                    #í‰ë‹¨ì„ í™•í™• ë‚´ë ¤ ì¤ë‹ˆë‹¤!

                                    BuyRound = int(StockInfo['Round']/4) + 1 #ë¬¼íƒˆ íšŒìˆ˜

                                    BuyAmt = int(((TotalMoney/50.0) * BuyRound) / CurrentPrice) #ë¬¼íƒˆ ìˆ˜ëŸ‰ì„ êµ¬í•œë‹¤!
                                    
                                    if BuyAmt < 1:
                                        BuyAmt = 1


                                    StockInfo['S_WaterAmt'] = BuyAmt

                                    #ì‹œì¥ê°€ ì£¼ë¬¸ì„ ë„£ëŠ”ë‹¤!
                                    #í˜„ì¬ê°€ë³´ë‹¤ ìœ„ì— ë§¤ìˆ˜ ì£¼ë¬¸ì„ ë„£ìŒìœ¼ë¡œì¨ ì‹œì¥ê°€ë¡œ ë§¤ìˆ˜!
                                    pprint.pprint(KisKR.MakeBuyMarketOrder(stock_code,int(BuyAmt)))

                                    msg = KisKR.GetStockName(stock_code) + "("+ stock_code  + ")  ì´í‰ì„ ì´ ìœ„ë¡œ êº¾ì˜€ì–´ìš”! í‰ë‹¨ì„ í™• ë‚®ì¶”ê¸° ìœ„í•œ ì´í‰ë¬´í•œë§¤ìˆ˜ë´‡ ë¬¼ì„ íƒ‘ë‹ˆë‹¤!! [" + str(BuyRound) + "] íšŒì°¨ ë§Œí¼ì˜ ìˆ˜ëŸ‰ì„ ì¶”ê°€ í–ˆì–´ìš”!"
                                    print(msg) 
                                    line_alert.SendMessage(msg) 
                                else:
                                    print("ì½”ë“œ ë§¨ ì²« ë¶€ë¶„ì— ENABLE_ORDER_EXECUTION ê°’ì„ Trueë¡œ ë³€ê²½í•´ì•¼ ë§¤ìˆ˜ë§¤ë„ê°€ ì§„í–‰ë©ë‹ˆë‹¤!")

                        #########################################################################################
                        #########################################################################################


                        #ìœ„ ë¡œì§ ì™„ë£Œí•˜ë©´ Nìœ¼ë¡œ ë°”ê¿”ì„œ ì˜¤ëŠ˜ ë§¤ìˆ˜ëŠ” ì•ˆë˜ê²Œ ì²˜ë¦¬!
                        StockInfo['IsReady'] = 'N' 

                        #íŒŒì¼ì— ì €ì¥
                        if ENABLE_ORDER_EXECUTION == True:
                            with open(bot_file_path, 'w') as outfile:
                                json.dump(InfinityMaDataList, outfile)
                            
                                


                break


else:

        
    #ì¥ì´ ëë‚˜ê³  ë‹¤ìŒë‚  ë‹¤ì‹œ ë§¤ìˆ˜ì‹œë„ í• ìˆ˜ ìˆê²Œ Yë¡œ ë°”ê¿”ì¤ë‹ˆë‹¹!
    for StockInfo in InfinityMaDataList:
        StockInfo['IsReady'] = 'Y' #

    #íŒŒì¼ì— ì €ì¥
    if ENABLE_ORDER_EXECUTION == True:
        with open(bot_file_path, 'w') as outfile:
            json.dump(InfinityMaDataList, outfile)
        
        

        
pprint.pprint(InfinityMaDataList)